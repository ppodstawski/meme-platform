(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{846:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/comments",function(){return t(1822)}])},1822:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(5893),s=t(7294),a=t(208),c=t(7568),i=t(9815),o=t(4051),u=t.n(o),l=t(7688),d=t(4420),m=t(4014),f=t(6675),h=function(e){var n=(0,s.useState)([]),t=n[0],a=n[1],o=(0,s.useState)(!1),h=o[0],p=o[1],v=(0,s.useCallback)((0,c.Z)(u().mark((function e(){var n,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,fetch(l.ZP.URLS.API_POST+"/get-my-comments",{method:"GET",credentials:"include"});case 4:return n=e.sent,e.next=7,n.json();case 7:(t=e.sent).ok&&a((function(e){return(0,i.Z)(e).concat((0,i.Z)(t.body))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0.message);case 14:return e.prev=14,p(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),[]),x=function(e){a((function(n){var t=Array.from(n),r=t.findIndex((function(n){return n.id===e}));return t.splice(r,1),t}))};return(0,s.useEffect)((function(){v()}),[v]),(0,r.jsxs)(s.Fragment,{children:[h&&(0,r.jsx)("p",{children:"Loading comments..."}),!h&&(0,r.jsx)("section",{className:"commonCard",children:t.length>0?t.map((function(e){var n=(0,d.v)(e.createdAt);return(0,r.jsx)(m.Z,{id:e.id,memeId:e.memeId,creator:{username:"You",profileImage:"images/no_profile_picture.png"},message:e.message,creationDate:n,removeHandler:x,showControls:!0,hideProfilePicture:!0},e.id)})):(0,r.jsx)(f.Z,{result:"error",message:"No comments found!"})})]})},p=function(){return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(a.Z,{}),(0,r.jsx)(h,{})]})}},208:function(e,n,t){"use strict";var r=t(5893),s=(t(7294),t(251)),a=t(5125),c=t.n(a);n.Z=function(){return(0,r.jsx)("nav",{className:c().adminNav,children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:(0,r.jsx)(s.O,{href:"/admin",children:(0,r.jsx)("a",{className:"navButton",children:"My memes"})})}),(0,r.jsx)("li",{children:(0,r.jsx)(s.O,{href:"/admin/add-meme",children:(0,r.jsx)("a",{className:"navButton",children:"Add new meme"})})}),(0,r.jsx)("li",{children:(0,r.jsx)(s.O,{href:"/admin/comments",children:(0,r.jsx)("a",{className:"navButton",children:"My comments"})})})]})})}},4014:function(e,n,t){"use strict";var r=t(7568),s=t(4051),a=t.n(s),c=t(5893),i=t(7294),o=t(7688),u=t(6642),l=t(6675),d=t(3749);n.Z=function(e){var n=(0,i.useState)(!1),t=n[0],s=n[1],m=(0,i.useState)(!1),f=m[0],h=m[1],p=(0,i.useState)(e.message),v=p[0],x=p[1],g=(0,i.useState)({result:"",message:""}),j=g[0],S=g[1],P=function(){var n=(0,r.Z)(a().mark((function n(){var t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return h(!0),n.prev=1,n.next=4,fetch(o.ZP.URLS.API_POST+"/delete-comment",{method:"DELETE",credentials:"include",body:JSON.stringify({commentId:e.id}),headers:{"Content-Type":"application/json"}});case 4:return t=n.sent,n.next=7,t.json();case 7:n.sent.ok&&e.removeHandler&&e.removeHandler(e.id),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),console.log(n.t0.message);case 14:return n.prev=14,h(!1),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[1,11,14,17]])})));return function(){return n.apply(this,arguments)}}();(0,i.useEffect)((function(){x(e.message)}),[e.message]);var N=e.showControls?" controls":"",Z=e.hideProfilePicture?" hideProfilePicture":"";return(0,c.jsxs)(i.Fragment,{children:[f&&(0,c.jsx)("div",{children:"Loading..."}),(0,c.jsxs)("div",{className:"commentField"+N+Z,children:[!f&&!t&&(0,c.jsxs)(i.Fragment,{children:[(0,c.jsxs)("p",{children:[!e.hideProfilePicture&&(0,c.jsx)(u.Z,{src:e.creator.profileImage,alt:e.creator.username,place:"COMMENTS"}),(0,c.jsxs)("b",{children:[e.creator.username,":"]})," ",v]}),(0,c.jsx)("time",{children:e.creationDate})]}),!f&&t&&(0,c.jsx)(d.Z,{messageStateHandler:S,loadingStateHandler:h,memeId:e.memeId,commentId:e.id,action:"UPDATE",filledMessage:v,onUpdateHandler:function(e){x(e),s(!1)}}),t&&j.message&&(0,c.jsx)(l.Z,{result:j.result,message:j.message}),e.showControls&&(0,c.jsxs)("div",{className:"commentControls",children:[(0,c.jsx)("button",{onClick:function(){s((function(e){return!e}))},className:t?"actionButton editing":"actionButton",children:t?"Stop editing":"Edit"}),(0,c.jsx)("button",{onClick:P,className:"actionButton",children:"Delete"})]})]})]})}},3749:function(e,n,t){"use strict";var r=t(7568),s=t(6042),a=t(4051),c=t.n(a),i=t(5893),o=t(7294),u=t(7688);n.Z=function(e){var n=(0,o.useRef)(),t=(0,o.useState)(e.filledMessage?e.filledMessage:""),a=t[0],l=t[1],d=function(){var n=(0,r.Z)(c().mark((function n(t){var r,i,o,l,d;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.preventDefault(),!(a.length>0)){n.next=27;break}return e.loadingStateHandler(!0),n.prev=3,r=u.ZP.URLS.API_POST+"/post-comment",i="POST","UPDATE"===e.action&&(r=u.ZP.URLS.API_POST+"/update-comment",i="PATCH"),o={memeId:e.memeId,message:a},e.commentId&&(o.commentId=e.commentId),n.next=11,fetch(r,{method:i,credentials:"include",body:JSON.stringify((0,s.Z)({},o)),headers:{"Content-Type":"application/json"}});case 11:return l=n.sent,n.next=14,l.json();case 14:!(d=n.sent).ok&&d.flash&&e.messageStateHandler(d.flash),d.ok&&e.onUpdateHandler&&e.onUpdateHandler(a),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(3),console.log(n.t0.message);case 22:return n.prev=22,e.loadingStateHandler(!1),n.finish(22);case 25:n.next=28;break;case 27:e.messageStateHandler({result:"error",message:"Please provide some message if you want to comment."});case 28:case"end":return n.stop()}}),n,null,[[3,19,22,25]])})));return function(e){return n.apply(this,arguments)}}();return(0,i.jsx)(o.Fragment,{children:(0,i.jsx)("div",{className:"comments",children:(0,i.jsxs)("form",{onSubmit:d,children:[(0,i.jsx)("input",{type:"hidden",ref:n,value:e.memeId}),(0,i.jsx)("input",{type:"text",onChange:function(e){l(e.target.value)},placeholder:"Type your comment here",value:a}),(0,i.jsx)("button",{children:"Submit comment"})]})})})}},6675:function(e,n,t){"use strict";var r=t(5893),s=(t(7294),t(9537)),a=t.n(s);n.Z=function(e){return(0,r.jsx)("div",{className:a().flashMessage,children:(0,r.jsx)("span",{className:"messageText "+e.result+"Msg",children:e.message})})}},4420:function(e,n,t){"use strict";t.d(n,{v:function(){return r}});var r=function(e){return new Date(e).toLocaleString("en-GB",{timeZone:"UTC"})}},5125:function(e){e.exports={adminNav:"AdminNav_adminNav__oH03H"}},9537:function(e){e.exports={flashMessage:"FlashMessage_flashMessage__2D1Ek"}},9815:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(943);var s=t(3375);var a=t(1566);function c(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,s.Z)(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(e){e.O(0,[774,888,179],(function(){return n=846,e(e.s=n);var n}));var n=e.O();_N_E=n}]);